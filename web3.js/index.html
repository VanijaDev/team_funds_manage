<!doctype html>
<html>
    <head>
        <title>Team funds manager</title>
        <script src="dist/web3.min.js"></script>
        <script type="text/javascript">
            if (typeof web3 !== 'undefined') {
                web3 = new Web3(web3.currentProvider);
            } else {
                // set the provider you want from Web3.providers
                web3 = new Web3(new Web3.providers.HttpProvider("http://localhost:8545"));
            }

            ///**************** CONTRACTS ***************//
            
            //  TEAM WALLET
            var teamWalletAddress = "0xaf171a9fbe57b04ebebc21d4263d48f295c4c177";
            var teamWalletABI = [{"constant":false,"inputs":[{"name":"walletAddress","type":"address"}],"name":"removePlayerWallet","outputs":[{"name":"","type":"bool"}],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"newOwner","type":"address"}],"name":"moveOwnership","outputs":[{"name":"","type":"bool"}],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[],"name":"teamName","outputs":[{"name":"","type":"string"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[{"name":"newName","type":"string"}],"name":"updateName","outputs":[{"name":"","type":"bool"}],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[{"name":"addr","type":"address"}],"name":"playerWalletName","outputs":[{"name":"","type":"string"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[],"name":"owner","outputs":[{"name":"","type":"address"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[{"name":"playerName","type":"bytes32"},{"name":"ownerAddress","type":"address"}],"name":"addPlayerWallet","outputs":[{"name":"","type":"address"}],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"playerWallet","type":"address"},{"name":"amount","type":"uint256"}],"name":"transferToPlayerWallet","outputs":[{"name":"","type":"bool"}],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[{"name":"","type":"address"}],"name":"playerWallets","outputs":[{"name":"","type":"address"}],"payable":false,"stateMutability":"view","type":"function"},{"inputs":[{"name":"_teamName","type":"string"}],"payable":true,"stateMutability":"payable","type":"constructor"},{"payable":true,"stateMutability":"payable","type":"fallback"},{"anonymous":false,"inputs":[{"indexed":false,"name":"name","type":"bytes32"},{"indexed":false,"name":"walletAddress","type":"address"}],"name":"LogPlayerWalletAdded","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"name":"name","type":"bytes32"},{"indexed":false,"name":"walletAddress","type":"address"}],"name":"LogPlayerWalletRemoved","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"name":"to","type":"address"},{"indexed":false,"name":"amount","type":"uint256"}],"name":"LogTransfer","type":"event"}];
            var teamWalletInst = web3.eth.contract(teamWalletABI).at(teamWalletAddress);
            
            //  PLAYER WALLET
            var playerWalletABI = [{"constant":true,"inputs":[],"name":"playerName","outputs":[{"name":"","type":"bytes32"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[{"name":"newOwner","type":"address"}],"name":"moveOwnership","outputs":[{"name":"","type":"bool"}],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[],"name":"showBalance","outputs":[{"name":"amount","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[],"name":"team","outputs":[{"name":"","type":"address"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[],"name":"getTeam","outputs":[{"name":"","type":"address"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[],"name":"owner","outputs":[{"name":"","type":"address"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[],"name":"getPlayerName","outputs":[{"name":"","type":"bytes32"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[{"name":"to","type":"address"},{"name":"amount","type":"uint256"}],"name":"transfer","outputs":[{"name":"","type":"bool"}],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[],"name":"walletManager","outputs":[{"name":"","type":"address"}],"payable":false,"stateMutability":"view","type":"function"},{"inputs":[{"name":"_playerName","type":"bytes32"},{"name":"_owner","type":"address"},{"name":"_team","type":"address"},{"name":"_walletManager","type":"address"}],"payable":true,"stateMutability":"payable","type":"constructor"},{"payable":true,"stateMutability":"payable","type":"fallback"},{"anonymous":false,"inputs":[{"indexed":false,"name":"to","type":"address"},{"indexed":false,"name":"amount","type":"uint256"}],"name":"LogTransfer","type":"event"}];
            
            ///**************** CONTRACTS ***************//

            function onloadFunction() {
                updateTeamData();
            }

            function updateTeamData() {
                //  name
                teamWalletInst.teamName((err, res) => {
                    if (err) {
                        handleError(err);
                        return;
                    }

                    document.getElementById('TeamName').innerText = res;
                });

                //  balance
                web3.eth.getBalance(teamWalletInst.address, (err, res) => {
                    if (err) {
                        handleError(err);
                        return;
                    }

                    document.getElementById('TeamBalance').innerText = web3.fromWei(res, 'ether');
                });

                //  owner 
                teamWalletInst.owner((err, res) => {
                    if (err) {
                        handleError(err);
                        return;
                    }

                    document.getElementById('TeamOwner').innerText = res;
                });

            }
            
            ///****************  enable / disable element ***************//
            function disableElement(elementID) {
                document.getElementById(elementID).classList.add('disabledElement');
            }
            
            function enableElement(elementID) {
                document.getElementById(elementID).classList.remove('disabledElement');
            }

            ///****************  hide / show element ***************//
            function hideElement(elementID) {
                document.getElementById(elementID).classList.add('hiddenElement');
            }
            
            function showElement(elementID) {
                document.getElementById(elementID).classList.remove('hiddenElement');
            }

            ///***************  create new Team **********//

            function createTeam() {
                let name = document.getElementById("CreateTeamName").value;
                let amount = document.getElementById("CreateTeamBalance").value;

                if (name.length == 0 || amount.length == 0) {
                    alert("Please, fill name & amount");
                    return;
                }


                
            }

            function getBalance() {
                web3.eth.getBalance(web3.eth.accounts[0], function(error, result) {
                    if (error) {
                        console.log("Error while getting balance: " + error);
                    } else {
                        document.getElementById("myBalance").innerText = web3.fromWei(result, "ether");
                    }
                });
            }
            ///***************  PRIVATE  **********//

            function handleError(error) {
                console.error(err);
                alert('Error');
            }

            ///***************  PRIVATE  **********//
        </script>
        
        <style>
            .disabledElement { 
                pointer-events: none; 
                opacity: 0.5;
            }

            .hiddenElement { 
                pointer-events: none; 
                opacity: 0;
            }
        </style>
    </head>
    <body onload="onloadFunction()">
        <div style="background-color: lightGray">
            <h2>Team Wallet</h2>
            <div id="Team">
                <div style="width: 400px; background-color: gray; float: left;">
                    <div>
                        <span>name: </span>
                        <span id="TeamName">...</span>
                    </div>
                    <div>
                        <span>balance: </span>
                        <span id="TeamBalance">...</span>
                        <span style="margin-left: 5px">Eth</span>
                    </div>
                    <div>
                        <span>owner: </span>
                        <span id="TeamOwner">...</span>
                    </div>
                </div>
                <div style="background-color:bisque;">
                    <button>Add Player wallet</button>
                    <input type="text" id="AddPlayerWalletName" placeholder="new Name">
                    <br/>
                    <button>Remove Player wallet</button>
                    <input type="text" id="RemovePlayerWalletName"  placeholder="address">
                    <br/>
                    <button>Transfer</button>
                    <input type="text" id="TransferTeamAmount"  placeholder="amount (Eth)">
                    <span> to </span>                
                    <input type="text" id="TransferAddress"  placeholder="address">
                </div>
            </div>
        </div>
        <div style="background-color:aqua; margin-top: 50px;">
            <h2>Player Wallets</h2>
            <button id="ShowAll">Show All</button>
            <div style="background-color:brown">
                <ul id="ShowAllNames" style="list-style-type: disc; background-color:aquamarine; float: left; margin-top: 0px; padding-right: 100px;">
                    <li>Coffeeeeeee</li>
                    <li>Tea</li>
                    <li>Milk</li>
                </ul>
                <ul id="ShowAllAddresses" style="list-style-type: none; background-color:cadetblue; ">
                    <li>(Coffee)</li>
                    <li>(Tea)</li>
                    <li>(Milk)</li>
                </ul>
            </div>
            <div>
                <button id="ShowBalance">Show balance</button>
                <span> of </span>
                <input type="text" id="ShowBalanceAddress"  placeholder="address">
                <span style="margin-left: 5px">is</span>
                <span style="margin-left: 5px">0.0</span>
                <span style="margin-left: 5px">Eth</span>

                <br/>
                <button id="TransferPlayerBalance">Transfer</button>
                <button id="TransferPlayerBalance" >Transfer</button>
                <span> from </span>
                <input type="text" id="TransferPlayerBalanceFrom"  placeholder="from address">
                <span> to </span>
                <input type="text" id="TransferPlayerBalanceTo"  placeholder="to address">
            </div>
        </div>
    </body>
</html>